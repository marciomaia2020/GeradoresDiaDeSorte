<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Jogos - Modalidade Milionária</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        .input-cell {
            background-color: #f9fafb;
            color: #374151;
            font-weight: bold;
            border: 2px solid #d1d5db;
        }
        .input-cell:focus {
            outline: 2px solid #3b82f6;
            border-color: #3b82f6;
        }
        .dark .input-cell {
            background-color: #374151;
            color: #f9fafb;
            border-color: #6b7280;
        }
        .trevo-cell {
            background-color: #10b981;
            color: white;
        }
        @media (max-width: 768px) {
            .table-container {
                overflow-x: auto;
            }
            .table-cell {
                min-width: 50px;
            }
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">
    <div class="container mx-auto p-4">
        <header class="text-center mb-6">
            <h1 class="text-3xl font-bold text-gray-800 dark:text-gray-200 mb-2">
                Gerador de Jogos - Modalidade Milionária
            </h1>
            <p class="text-gray-600 dark:text-gray-400">
                Sistema profissional para geração de 12 jogos
            </p>
        </header>

        <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4 mb-6">
            <h2 class="text-lg font-semibold mb-3">Instruções</h2>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
                <li>• Insira 4 números de 1 a 50 no GRUPO I - (46)</li>
                <li>• Insira 4 números de 1 a 50 no GRUPO II - (46)</li>
                <li>• Cada jogo terá 6 números principais + 2 números do trevo</li>
            </ul>
        </div>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                <h3 class="text-lg  text-center font-semibold mb-3 text-red-600">GRUPO I</h3>
                <div class="grid grid-cols-4 gap-2">
                    <input type="number" id="grupo1-0" min="1" max="50" placeholder="1°" class="input-cell h-12 text-center rounded text-base">
                    <input type="number" id="grupo1-1" min="1" max="50" placeholder="2°" class="input-cell h-12 text-center rounded text-base">
                    <input type="number" id="grupo1-2" min="1" max="50" placeholder="3°" class="input-cell h-12 text-center rounded text-base">
                    <input type="number" id="grupo1-3" min="1" max="50" placeholder="4°" class="input-cell h-12 text-center rounded text-base">
                </div>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                <h3 class="text-lg text-center font-semibold mb-3 text-blue-600">GRUPO II</h3>
                <div class="grid grid-cols-4 gap-2">
                    <input type="number" id="grupo2-0" min="1" max="50" placeholder="1°" class="input-cell h-12 text-center rounded text-base">
                    <input type="number" id="grupo2-1" min="1" max="50" placeholder="2°" class="input-cell h-12 text-center rounded text-base">
                    <input type="number" id="grupo2-2" min="1" max="50" placeholder="3°" class="input-cell h-12 text-center rounded text-base">
                    <input type="number" id="grupo2-3" min="1" max="50" placeholder="4°" class="input-cell h-12 text-center rounded text-base">
                </div>
            </div>
        </div>

        <div class="table-container bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-6">
            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="bg-gray-100 dark:bg-gray-700">
                            <th class="border border-gray-300 dark:border-gray-600 p-2 text-center">Jogo</th>
                            <th colspan="6" class="border border-gray-300 dark:border-gray-600 p-2 text-center">Números Principais</th>
                            <th colspan="2" class="border border-gray-300 dark:border-gray-600 p-2 text-center bg-green-100 dark:bg-green-900">TREVO</th>
                        </tr>
                    </thead>
                    <tbody id="gameTable">
                        <!-- Jogos serão gerados aqui -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="flex flex-wrap gap-4 justify-center mb-6">
            <button onclick="clearAll()" 
                    class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                Limpar Tudo
            </button>
        </div>

        <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
            <h3 class="text-lg font-semibold mb-3">Downloads</h3>
            <div class="flex flex-wrap gap-3">
                <button onclick="downloadHTML()" 
                        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded font-medium transition-colors">
                    Download HTML
                </button>
                <button onclick="downloadTXT()" 
                        class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded font-medium transition-colors">
                    Download TXT
                </button>
                <button onclick="downloadXLS()" 
                        class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded font-medium transition-colors">
                    Download XLS
                </button>
            </div>
        </div>
    </div>

    <script>
        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        let gameData = [];

        function generateGames() {
            // Pegar valores dos inputs dos grupos
            const grupo1 = [];
            const grupo2 = [];
            
            for (let i = 0; i < 4; i++) {
                const val1 = parseInt(document.getElementById(`grupo1-${i}`).value) || 0;
                const val2 = parseInt(document.getElementById(`grupo2-${i}`).value) || 0;
                grupo1.push(val1);
                grupo2.push(val2);
            }

            gameData = [];
            const tableBody = document.getElementById('gameTable');
            tableBody.innerHTML = '';

            // Combinações baseadas na figura - mantendo grupos corretos
            const combinations = [
                { g1: [0,1,2,3], g2: [0,1], trevo: [1,2] },    // Jogo 1: Todo grupo1 + 1°,2° do grupo2
                { g1: [0,1,2,3], g2: [0,2], trevo: [1,3] },    // Jogo 2: Todo grupo1 + 1°,3° do grupo2  
                { g1: [0,1,2,3], g2: [0,3], trevo: [1,4] },    // Jogo 3: Todo grupo1 + 1°,4° do grupo2
                { g1: [0,1,2,3], g2: [1,2], trevo: [2,5] },    // Jogo 4: Todo grupo1 + 2°,3° do grupo2
                { g1: [0,1,2,3], g2: [1,3], trevo: [1,6] },    // Jogo 5: Todo grupo1 + 2°,4° do grupo2
                { g1: [0,1,2,3], g2: [2,3], trevo: [2,3] },    // Jogo 6: Todo grupo1 + 3°,4° do grupo2
                { g1: [], g2: [0,1,2,3], trevo: [3,4] },       // Jogo 7: 20,34,38,40 (todos do grupo2)
                { g1: [0], g2: [0,1,2], trevo: [3,5] },        // Jogo 8: 3 + 20,34,38
                { g1: [], g2: [0,1,2,3], trevo: [4,5] },       // Jogo 9: repete 20,34,38,40
                { g1: [2], g2: [0,1,3], trevo: [2,4] },        // Jogo 10: 10 + 20,34,40
                { g1: [3], g2: [0,1,2], trevo: [2,5] },        // Jogo 11: 12 + 20,34,38
                { g1: [1,2], g2: [0,3], trevo: [2,6] }         // Jogo 12: 8,10 + 20,40
            ];

            for (let i = 0; i < 12; i++) {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 dark:border-gray-700';
                
                const combo = combinations[i];
                const gameNumbers = [];
                
                if (i >= 6) { // Jogos 7-12 (índices 6-11)
                    // Para jogos 7-12: APENAS usar números do GRUPO II, NUNCA do GRUPO I
                    combo.g2.forEach(idx => {
                        if (grupo2[idx] > 0) gameNumbers.push(grupo2[idx]);
                    });
                    
                    // Se houver números do GRUPO I especificados na combinação, 
                    // só usar se GRUPO II estiver completo
                    if (combo.g1.length > 0) {
                        let grupo2Completo = combo.g2.every(idx => grupo2[idx] > 0);
                        if (grupo2Completo) {
                            combo.g1.forEach(idx => {
                                if (grupo1[idx] > 0) gameNumbers.push(grupo1[idx]);
                            });
                        }
                    }
                } else { // Jogos 1-6
                    // Adicionar números do grupo 1
                    combo.g1.forEach(idx => {
                        if (grupo1[idx] > 0) gameNumbers.push(grupo1[idx]);
                    });
                    
                    // Adicionar números do grupo 2
                    combo.g2.forEach(idx => {
                        if (grupo2[idx] > 0) gameNumbers.push(grupo2[idx]);
                    });
                }
                
                // Ordenar os números
                gameNumbers.sort((a, b) => a - b);
                
                const game = {
                    numero: i + 1,
                    numeros: gameNumbers,
                    trevo: combo.trevo
                };

                // Número do jogo
                const gameCell = document.createElement('td');
                gameCell.className = 'border border-gray-300 dark:border-gray-600 p-2 text-center font-bold';
                gameCell.textContent = i + 1;
                row.appendChild(gameCell);

                // 6 números principais
                for (let j = 0; j < 6; j++) {
                    const cell = document.createElement('td');
                    cell.className = 'border border-gray-300 dark:border-gray-600 p-2 text-center table-cell';
                    cell.textContent = gameNumbers[j] || '-';
                    row.appendChild(cell);
                }

                // 2 números do trevo
                for (let j = 0; j < 2; j++) {
                    const cell = document.createElement('td');
                    cell.className = 'border border-gray-300 dark:border-gray-600 p-2 text-center trevo-cell table-cell';
                    cell.textContent = combo.trevo[j] || '-';
                    row.appendChild(cell);
                }

                tableBody.appendChild(row);
                gameData.push(game);
            }
        }

        function addInputListeners() {
            for (let i = 0; i < 4; i++) {
                document.getElementById(`grupo1-${i}`).addEventListener('input', generateGames);
                document.getElementById(`grupo2-${i}`).addEventListener('input', generateGames);
            }
        }

        function clearAll() {
            showConfirmDialog('Tem certeza que deseja limpar todos os campos?', () => {
                for (let i = 0; i < 4; i++) {
                    document.getElementById(`grupo1-${i}`).value = '';
                    document.getElementById(`grupo2-${i}`).value = '';
                }
                generateGames();
            });
        }

        function downloadHTML() {
            const content = generateHTMLContent();
            downloadFile('jogos-milionaria.html', content, 'text/html');
        }

        function downloadTXT() {
            const content = generateTXTContent();
            downloadFile('jogos-milionaria.txt', content, 'text/plain');
        }

        function downloadXLS() {
            const ws_data = [['Jogo', '1°', '2°', '3°', '4°', '5°', '6°', 'Trevo 1', 'Trevo 2']];
            
            gameData.forEach(game => {
                const row = [
                    game.numero,
                    ...game.numeros.concat(Array(6 - game.numeros.length).fill('')),
                    ...game.trevo
                ];
                ws_data.push(row);
            });

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(ws_data);
            XLSX.utils.book_append_sheet(wb, ws, "Jogos");
            XLSX.writeFile(wb, "jogos-milionaria.xlsx");
        }

        function generateHTMLContent() {
            let html = `
                <html>
                <head><title>Jogos Milionária</title></head>
                <body>
                <h1>Jogos - Modalidade Milionária</h1>
                <table border="1">
                <tr><th>Jogo</th><th>1°</th><th>2°</th><th>3°</th><th>4°</th><th>5°</th><th>6°</th><th>Trevo 1</th><th>Trevo 2</th></tr>
            `;
            
            gameData.forEach(game => {
                html += `<tr><td>${game.numero}</td>`;
                for (let i = 0; i < 6; i++) {
                    html += `<td>${game.numeros[i] || '-'}</td>`;
                }
                html += game.trevo.map(n => `<td>${n}</td>`).join('');
                html += '</tr>';
            });
            
            html += '</table></body></html>';
            return html;
        }

        function generateTXTContent() {
            let content = 'JOGOS - MODALIDADE MILIONÁRIA\n\n';
            gameData.forEach(game => {
                content += `Jogo ${game.numero}:\n`;
                content += `Números: ${game.numeros.join(', ')}\n`;
                content += `Trevo: ${game.trevo.join(', ')}\n\n`;
            });
            return content;
        }

        function downloadFile(filename, content, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function showConfirmDialog(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${message}</p>
                    <div class="flex justify-end space-x-3">
                        <button class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded" onclick="this.closest('.fixed').remove()">Cancelar</button>
                        <button class="px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded" onclick="this.closest('.fixed').remove(); onConfirm()">Confirmar</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Inicializar a aplicação
        addInputListeners();
        generateGames();
		
		// Lógica para evitar repetições entre os grupo I e grupo II
		  const grupo1Inputs = Array.from({ length: 4 }, (_, i) => document.getElementById(`grupo1-${i}`));
		  const grupo2Inputs = Array.from({ length: 4 }, (_, i) => document.getElementById(`grupo2-${i}`));

		  function getGrupo1Valores() {
			return grupo1Inputs.map(input => parseInt(input.value)).filter(num => !isNaN(num));
		  }

		  grupo2Inputs.forEach(input => {
			input.addEventListener("input", () => {
			  const grupo1Valores = getGrupo1Valores();
			  const valor = parseInt(input.value);

			  if (grupo1Valores.includes(valor)) {
				alert(`O número ${valor} já foi selecionado no GRUPO I. Escolha outro número.`);
				input.value = "";
				input.focus();
			  }
			});
		  });
    </script>
  </body>
</html>